\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{indentfirst}
\usepackage{misccorr}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{mathtools}
\begin{document}

\section{Система ранжирования}



\section{Зависимости}

\begin{itemize}
    \item C++14
    \item UbjsonCpp  - библиотека для работы протокола (repo: https://github.com/NightCodersss/UbjsonCpp)
    \item cppunit - библиотека для unit-тестирования (используется в Ubjson)
\end{itemize}

\section{Разработчику}
Помимо информации, изложенной здесь, следует изучить документацию, сгенерированную doxygen'ом (директории latex и html в корне проекта).

\subsection{Структура}
\label{subsec:generalStructure}
Структура выглядит так:
(Фронт-энд или другой сервис) $\rightarrow{Южный протокол} Ranking System \rightarrow{Северный протокол} IndexServer$
Где $'\rightarrow'$ обозначет подключение от клиента к серверу.

\subsection{Протокол}
В связи с тем, что Ubjson парсится на лету, не все поля обязательны. 
В силу гибкости протокола незначительное изменение или значительное добавление не должно требовать больших трудов.
Что такое южный и северный легко понять отсюда \ref{subsec:generalStructure}.

\subsubsection{Южный}
Необходимо передавать строчку query, которая хранит в себе запрос.
\begin{verbatim}
{
	query: "what is ...?"
}
\end{verbatim}
Планируется добавить параметры, каким образом представлять информацию о документе обратно.

Заглушка работает так: слушает некоторый порт, по приходу данных, до переноса строки ($\backslash n$), приходящие данные пакует в ubjson и отправляет системе ранжирования. По приходу данных от системы ранжирования (то есть системы поиска)(в ubjson) заглушка "их отвечает" в json (обычном).

\subsubsection{Северный}
Такой же, как "южный", но с параметром - какой индекс использовать (по какому тексту). 

\subsubsection{Реализация}
Ясно, что нехорошо ждать каждого ответа. 
Глобально, есть два пути решения этой проблемы: использование асинхронных операций ввода-вывода (с callback'ами) и использование большого количества потоков. Существенных различий нет (нам известных), за исключением того, что код с большим количеством callback'ов плохо читаем и некрасив.

Итак, реализация такова, что на каждое соединение выделется отдельный поток, в котором соединение работает синхронно.

\section{Программистам-пользователям}
См. структуру \ref{subsec:generalStructure}

\section{Человеку, который запускает}
См. структуру \ref{subsec:generalStructure}

\end{document}
